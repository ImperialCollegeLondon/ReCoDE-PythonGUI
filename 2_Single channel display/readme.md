## Python GUI programming Day 2
With what you have learned from Day1, you can create a GUI that displays a single channel of data. The widget we need is plotting widget, which is used to display the data.

In this session we are going to create a GUI that displays a single channel of data. You will learn both how to plot data generated by program and how to plot data from file.

You have created a plot widgte that can show data statically. However, in most cases, we need to plot data dynamically. That is, the data is changing with time. In this case, we need to update the plot widget with new data. The function ```start_dearpygui()``` is used to start the GUI. However, it is a blocking function. That is, the program will be blocked at this function. Therefore, we cannot update the plot widget. Therefore, we are going to replace ```start_dearpygui()``` with a while loop. The while loop will keep running until the GUI is closed. The function ```render_dearpygui_frame()``` is used to update the GUI. Therefore, the code for GUI is as follows: 
```python
while dpg.is_dearpygui_running():
    ### function to be executed ###
    dpg.render_dearpygui_frame()
```

Two python files are provided.
* `python_gui_day2_simple.py` is to plot data generated by program.
* `python_gui_day2_file.py` is to plot data from file.

### Hints for open-source data
There are many open-source databases available online. Different databases have different data format. Here we choose one of the most commonly used open-source databased for physiological data. The data is from [PhysioNet](https://physionet.org/physiobank/database/ptbdb/). There is a special data format for data from Physionet. You will learn how to read the data from Physionet.

### Steps for plot data generated by program
1. We will use the virtual enviroment created in Day1. Activate the environment using the following command:
```conda activate GUI```
2. Import libraries. In addition to Dearpygui imported in Day1, we need to import ```math``` library to generate data. The ```math``` module comes packaged with the standard Python installation. So, it is a built-in Python module, and to use it you just need to import it. We will use the ```cos``` function in ```math``` library to generate data.
```python
import dearpygui.dearpygui as dpg
from math import cos
```
3. Create a GUI window with a plot widget. The code is the same as Day1. Create a window using the window() function and copy the following code after ```with dpg.window()``` to create a plot widget to the window.
```python
 # The following codes create a plot widget
with dpg.plot(label="Line Series", height=300, width=400):
# optionally create legend
    dpg.add_plot_legend()
    # REQUIRED: create x and y axes
    dpg.add_plot_axis(dpg.mvXAxis, label="x")
    dpg.add_plot_axis(dpg.mvYAxis, label="y", tag="y_axis")
    # series belong to a y axis
    # you need to change datax and datay to your data
    dpg.add_line_series(datax, datay, label="0.5 + 0.5 * sin(x)", parent="y_axis") 
```
4. Create a function to generate data. 
```python
def update_series(j):
    cosdatax = []
    cosdatay = []
    for i in range(0, 500):
        cosdatax.append(i / 1000)
        cosdatay.append(0.5 + 0.5 * cos(50 * (i+j) / 1000))
```
5. Send the data to the plot widget for display. Here, we set the tag for the plot widgte as ```tag="series_tag```. Then we can use the tag to update the data in the plot widget. The code is as follows:
```python
dpg.set_value("series_tag", [cosdatax, cosdatay])
```
The full codes can be found in `python_gui_day2_simple.py`.

### Steps for plot data from file
The steps for plotting data from file are exactly the same as plotting data generated by program. The only difference is that we need to read data from file. We provide a sample data from CHARIS database. The data is from [PhysioNet](https://physionet.org/content/charisdb/1.0.0/). The CHARIS database contains multi-channel recordings of ECG, arterial blood pressure (ABP), and intracranial pressure (ICP) of patients diagnosed with traumatic brain injury (TBI). 

A record from Physionet comes with two files, one is data.txt and the other is data.dat. The data.txt file contains information about the data, so called header file. The data.dat file contains the data. The format of header file can be found in the [Documentation from Physionet](https://physionet.org/physiotools/wag/header-5.htm).  
In this example, we are going to use ADC gain (ADC units per physical unit) and ADC baseline. ADC gain is a floating-point number that specifies the difference in sample values that would be observed if a step of one physical unit occurred in the original analog signal. For example, the **ADC gain** for **ABP** is **91.5061**. Therefore, we need to divide the data by 91.5061 to get the real data. ADC baseline is surrounded by parentheses after ADC gain. The baseline is an integer that specifies the sample value corresponding to 0 physical units.  
For example, from charis4.txt we can find 91.5061(-2644)/mmHg for ABP. Therefore, we need to divide the data by 91.5061 and add 2644 to get the real data, and the unit is mmHg.  
Another important parameter is sampling frequency, which is the number of samples per second. For example, the sampling frequency is **50 Hz** in this record (the third parameter in the first line). Therefore, the time interval between two samples is 1/50 = 0.02 s.


The following codes are used to read data from file:
```python
datafile =open(filename, 'rb')
dtype = np.dtype('int16')
data = np.fromfile(datafile,dtype)
# The data are stored in the following order: ABP,ECG,ICP
ABP  = [(data[i]+2644)/91.5061 for i in range(0, len(data), 3)]
ECG  = [(data[i]+392)/6081.8245 for i in range(1, len(data), 3)]
ICP  = [(data[i]+5)/84.0552 for i in range(2, len(data), 3)]
```
